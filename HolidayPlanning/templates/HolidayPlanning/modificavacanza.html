{% extends 'base.html' %}
{% block head %}
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static '/css/style.css' %}">
    {% load crispy_forms_tags %}
{% endblock %}

{% block title %}{{ title }}{% endblock %}
{% block content %}
    <script src="{% static 'js/modificaVacanzaConferma.js' %}"></script>
    {% include "header.html" %}
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-4">
                <h2> Dettagli Attuali Vacanza </h2>
                <ul class="list-unstyled">
                    <li>Data di Arrivo: {{ object.dataArrivo }} </li>
                    <li>Data di Partenza: {{ object.dataPartenza }} </li>
                    <li>Numero di persone: {{ object.nrPersone }} </li>
                    <li>Budget Disponibile: {{ object.budgetDisponibile }} </li>
                    <li>Nome Vacanza: {{ object.nome }} </li>
                </ul>
            </div>
            <div class="col-md-4">
                <h2>Inserisci i dati per modificare la tua vacanza!</h2>
                <form method="post" enctype="multipart/form-data" id="modificaVacanzaForm">
                    {% csrf_token %}
                    {{ form.nome | as_crispy_field }}
                    {{ form.dataArrivo | as_crispy_field }}
                    {{ form.dataPartenza | as_crispy_field }}
                    {{ form.nrPersone | as_crispy_field }}
                    {{ form.budgetDisponibile | as_crispy_field }}
                    <button type="button" value="Submit" class="btn btn-primary" name="SubmitButton" id="submitButton">
                        Aggiorna Vacanza
                    </button>
                </form>
                <a class="btn" href="{% url 'HolidayPlanning:vacanze' %}">Annulla</a>
            </div>
            <div class="col-md-4">
                <h3>Riassunto vacanza</h3>
                <ul class="list-group">
                    {% for s in vacanza.sort_scelte %}
                        {% ifchanged s.giorno %}
                            <h5>Giornata {{ forloop.counter }}: {{ s.giorno }}</h5>
                        {% endifchanged %}
                        <li class="list-group-item">{{ s.attrazione.nome }} dalle {{ s.oraInizio }}
                            alle {{ s.oraFine }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var nuovaDataPartenza = document.querySelector('input[name="dataPartenza"]').value;
        var nuovaDataArrivo = document.querySelector('input[name="dataArrivo"]').value;
        var inputElement = document.getElementById("submitButton")
        inputElement.addEventListener("click", function (){
            if (confirm('Vuoi modificare la vacanza? \n nuova data partenza: '+nuovaDataPartenza+
                '\n nuova data arrivo: '+nuovaDataArrivo)){
                document.getElementById("modificaVacanzaForm").submit()
            } else {
                return false;
            }
        })
    </script>
{% endblock %}

